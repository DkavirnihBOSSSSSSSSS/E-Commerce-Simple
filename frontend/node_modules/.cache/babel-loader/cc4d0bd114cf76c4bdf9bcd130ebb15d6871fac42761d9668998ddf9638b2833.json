{"ast":null,"code":"import { jwtDecode } from \"jwt-decode\";\nimport refreshToken from \"./refreshToken\";\nconst TokenRefresher = token => {\n  const refreshThreshold = 1 * 60 * 1000; // 1 minute in milliseconds\n  const decodedToken = jwtDecode(token);\n  const expirationTime = decodedToken.exp * 1000;\n  const refreshFunction = () => {\n    refreshToken(token).then(newToken => {\n      // Call TokenRefresher recursively with the new token\n      TokenRefresher(newToken);\n    }).catch(error => {\n      console.error('Error refreshing token:', error);\n      // Handle error appropriately\n    });\n  };\n  const interval = setInterval(() => {\n    const remainingTime = expirationTime - Date.now();\n    if (remainingTime <= refreshThreshold) {\n      clearInterval(interval);\n      refreshFunction();\n    }\n  }, 4000); // Check every second\n\n  return () => clearInterval(interval);\n};\n_c = TokenRefresher;\nexport default TokenRefresher;\nvar _c;\n$RefreshReg$(_c, \"TokenRefresher\");","map":{"version":3,"names":["jwtDecode","refreshToken","TokenRefresher","token","refreshThreshold","decodedToken","expirationTime","exp","refreshFunction","then","newToken","catch","error","console","interval","setInterval","remainingTime","Date","now","clearInterval","_c","$RefreshReg$"],"sources":["C:/Tugas/Semester 5/E-Commerce-react-node-mysql-main/client/src/components/Utils/token.js"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\nimport refreshToken from \"./refreshToken\";\n\nconst TokenRefresher = (token) => {\n    const refreshThreshold = 1 * 60 * 1000; // 1 minute in milliseconds\n    const decodedToken = jwtDecode(token);\n    const expirationTime = decodedToken.exp * 1000;\n\n    const refreshFunction = () => {\n        refreshToken(token)\n            .then(newToken => {\n                // Call TokenRefresher recursively with the new token\n                TokenRefresher(newToken);\n            })\n            .catch(error => {\n                console.error('Error refreshing token:', error);\n                // Handle error appropriately\n            });\n    };\n\n    const interval = setInterval(() => {\n        const remainingTime = expirationTime - Date.now();\n        if (remainingTime <= refreshThreshold) {\n            clearInterval(interval);\n            refreshFunction();\n        }\n    }, 4000); // Check every second\n\n    return () => clearInterval(interval);\n};\n\nexport default TokenRefresher;\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AACtC,OAAOC,YAAY,MAAM,gBAAgB;AAEzC,MAAMC,cAAc,GAAIC,KAAK,IAAK;EAC9B,MAAMC,gBAAgB,GAAG,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;EACxC,MAAMC,YAAY,GAAGL,SAAS,CAACG,KAAK,CAAC;EACrC,MAAMG,cAAc,GAAGD,YAAY,CAACE,GAAG,GAAG,IAAI;EAE9C,MAAMC,eAAe,GAAGA,CAAA,KAAM;IAC1BP,YAAY,CAACE,KAAK,CAAC,CACdM,IAAI,CAACC,QAAQ,IAAI;MACd;MACAR,cAAc,CAACQ,QAAQ,CAAC;IAC5B,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,IAAI;MACZC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C;IACJ,CAAC,CAAC;EACV,CAAC;EAED,MAAME,QAAQ,GAAGC,WAAW,CAAC,MAAM;IAC/B,MAAMC,aAAa,GAAGV,cAAc,GAAGW,IAAI,CAACC,GAAG,CAAC,CAAC;IACjD,IAAIF,aAAa,IAAIZ,gBAAgB,EAAE;MACnCe,aAAa,CAACL,QAAQ,CAAC;MACvBN,eAAe,CAAC,CAAC;IACrB;EACJ,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;;EAEV,OAAO,MAAMW,aAAa,CAACL,QAAQ,CAAC;AACxC,CAAC;AAACM,EAAA,GA1BIlB,cAAc;AA4BpB,eAAeA,cAAc;AAAC,IAAAkB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}